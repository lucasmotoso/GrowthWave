# üìê Measures.md  
## Medidas DAX + Script C# (Tabular Editor)  
### Projeto: An√°lise Executiva de Performance Comercial ‚Äì Growth Wave

Este documento consolida **todas as medidas DAX utilizadas no projeto** e o **script em C#** aplicado no Tabular Editor para automatizar a cria√ß√£o das medidas.  
Ele faz parte da documenta√ß√£o t√©cnica do reposit√≥rio e demonstra dom√≠nio de boas pr√°ticas de modelagem, governan√ßa e produtividade em Power BI.

---

# üßÆ 1. MEDIDAS DAX (DOCUMENTADAS)

---

## **Medidas DAX**
```DAX
TotalVendas =
SUM ( Vendas[ValorVenda] )

TotalCusto =
SUM ( Vendas[Custo] )

LucroTotal =
[TotalVendas] - [TotalCusto]

MargemMedia =
DIVIDE ( [LucroTotal], [TotalVendas] )

MargemMedia =
DIVIDE ( [LucroTotal], [TotalVendas] )

ComissaoValor =
SUMX (
    Vendas,
    Vendas[ValorVenda] * Vendas[Comiss√£o (Percentual)] / 100
)

LucroPorProduto =
SUMX (
    VALUES ( Vendas[ID-Produto] ),
    CALCULATE ( SUM ( Vendas[ValorVenda] ) - SUM ( Vendas[Custo] ) )
)

RankFabricante =
RANKX (
    ALL ( Vendas[Fabricante] ),
    [TotalVendas],
    ,
    DESC,
    DENSE
)

TopN_Vendas =
IF (
    RANKX (
        ALLSELECTED ( Vendas[Fabricante] ),
        [TotalVendas],
        ,
        DESC,
        DENSE
    ) <= 5,
    [TotalVendas],
    BLANK ()
)

Outros_Vendas =
VAR TotalGeral = [TotalVendas]
VAR Top5 =
    CALCULATE (
        [TotalVendas],
        TOPN ( 5, VALUES ( Vendas[Fabricante] ), [TotalVendas], DESC )
    )
RETURN
    TotalGeral - Top5
```

  # üß† 2. SCRIPT C# ‚Äì TABULAR EDITOR  
### Automa√ß√£o para cria√ß√£o e atualiza√ß√£o das medidas DAX
## **Medidas C#**
```csharp
using System.Linq;

// 1) Cria a tabela calculada "Medidas" se n√£o existir
var tabela = Model.Tables.FirstOrDefault(t => t.Name == "Medidas");
if (tabela == null)
{
    // DATATABLE cria uma tabela pequena e in√≥cua; ser√° ocultada em seguida
    tabela = Model.AddCalculatedTable("Medidas", "DATATABLE(\"_placeholder\", INTEGER, {{1}})");
    tabela.IsHidden = true; // oculta a tabela para n√£o aparecer em visuais
}
else
{
    // garante que a tabela esteja oculta se j√° existir
    tabela.IsHidden = true;
}

// 2) Helper para criar/atualizar medidas na tabela "Medidas"
Action<string, string, string> CriarMedida = (nome, expressao, formato) =>
{
    var existente = tabela.Measures.FirstOrDefault(m => m.Name == nome);
    if (existente != null)
    {
        existente.Expression = expressao;
        existente.FormatString = formato;
    }
    else
    {
        var m = tabela.AddMeasure(nome, expressao);
        m.FormatString = formato;
    }
};

// 3) Medidas (DAX sem '=' no in√≠cio). Ajuste nomes de tabelas/colunas se necess√°rio.
CriarMedida("TotalVendas", @"SUM(Vendas[ValorVenda])", "R$ #,0.00");
CriarMedida("TotalCusto", @"SUM(Vendas[Custo])", "R$ #,0.00");
CriarMedida("LucroTotal", @"[TotalVendas] - [TotalCusto]", "R$ #,0.00");
CriarMedida("MargemMedia", @"DIVIDE([LucroTotal], [TotalVendas])", "0.00%");

CriarMedida("ComissaoValor", @"SUMX(Vendas, Vendas[ValorVenda] * Vendas[Comiss√£o (Percentual)] / 100)", "R$ #,0.00");

CriarMedida("LucroPorProduto",
@"SUMX(
    VALUES(Vendas[ID-Produto]),
    CALCULATE(SUM(Vendas[ValorVenda]) - SUM(Vendas[Custo]))
)", "R$ #,0.00");

CriarMedida("VendasYTD", @"TOTALYTD([TotalVendas], 'Calendario'[Data])", "R$ #,0.00");

CriarMedida("CrescimentoPeriodo",
@"VAR VendasAtual = [TotalVendas]
VAR VendasAnoAnterior = CALCULATE([TotalVendas], SAMEPERIODLASTYEAR('Calendario'[Data]))
RETURN DIVIDE(VendasAtual - VendasAnoAnterior, VendasAnoAnterior, 0)", "0.00%");

CriarMedida("RankFabricante", @"RANKX(ALL(Vendas[Fabricante]), [TotalVendas], , DESC, DENSE)", "0");

CriarMedida("TopN_Vendas",
@"IF(
    RANKX(ALLSELECTED(Vendas[Fabricante]), [TotalVendas], , DESC, DENSE) <= 5,
    [TotalVendas],
    BLANK()
)", "R$ #,0.00");

CriarMedida("Outros_Vendas",
@"VAR TotalGeral = [TotalVendas]
VAR Top5 = CALCULATE([TotalVendas], TOPN(5, VALUES(Vendas[Fabricante]), [TotalVendas], DESC))
RETURN TotalGeral - Top5", "R$ #,0.00");

// Observa√ß√£o: n√£o chamamos Model.SaveChanges() aqui porque algumas builds n√£o exp√µem esse m√©todo.
// Salve as altera√ß√µes pela UI: Model -> Save Changes (Ctrl+S)
  ```

  # üß© 3. DECIS√ïES ANAL√çTICAS  
### Crit√©rios, escolhas de modelagem e l√≥gica por tr√°s das an√°lises

Esta se√ß√£o documenta **as decis√µes anal√≠ticas** tomadas durante o desenvolvimento do dashboard *An√°lise Executiva de Performance Comercial ‚Äì Growth Wave*.  
O objetivo √© registrar a l√≥gica estrat√©gica por tr√°s das escolhas de m√©tricas, visuais, filtros e estrutura narrativa, garantindo clareza para avaliadores t√©cnicos, recrutadores e outros analistas.

---

## üéØ 3.1 Princ√≠pios que guiaram a an√°lise

As decis√µes foram baseadas em quatro pilares:

1. **Clareza executiva**  
   - Priorizar indicadores que respondem perguntas de neg√≥cio.  
   - Evitar excesso de visuais ou m√©tricas redundantes.  

2. **Consist√™ncia anal√≠tica**  
   - Mesmas medidas DAX utilizadas em todas as p√°ginas.  
   - Padr√µes de cores e formatos replicados em todo o dashboard.  

3. **Navega√ß√£o orientada √† decis√£o**  
   - Estrutura em camadas: vis√£o geral ‚Üí diagn√≥stico ‚Üí detalhe.  
   - P√°ginas independentes, mas conectadas por filtros sincronizados.  

4. **Performance e governan√ßa**  
   - Uso de medidas ao inv√©s de colunas calculadas.  
   - Modelo estrela limpo e com relacionamentos unidirecionais.  

---

## üìä 3.2 Decis√µes sobre KPIs

### KPIs escolhidos:
- **Total de Vendas**  
- **Lucro Total**  
- **Margem (%)**  
- **Custo Total**  
- **Ticket M√©dio**  
- **Comiss√µes Pagas**

### Justificativa:
- Representam **sa√∫de financeira** e **efici√™ncia comercial**.  
- S√£o m√©tricas universais em opera√ß√µes de varejo e distribui√ß√£o.  
- Permitem an√°lises comparativas entre categorias, produtos, lojas e vendedores.

---

## üß± 3.3 Decis√µes sobre Modelagem

### Modelo Estrela
- 1 tabela fato (`F_Vendas`)  
- 4 dimens√µes principais (`D_Produto`, `D_Tempo`, `D_Loja`, `D_Vendedor`)  

**Por qu√™?**
- Facilita cria√ß√£o de medidas reutiliz√°veis.  
- Melhora performance do Power BI.  
- Evita ambiguidade de relacionamentos.  

### Relacionamentos unidirecionais
- Evita loops e ambiguidade.  
- Mant√©m o fluxo de filtro previs√≠vel.

---

## üìà 3.4 Decis√µes sobre Visuais

### Storytelling
- Linha temporal ‚Üí tend√™ncia  
- Rosca ‚Üí participa√ß√£o  
- Barras ‚Üí ranking  
- KPIs ‚Üí vis√£o executiva  

**Motivo:**  
Cada visual responde uma pergunta espec√≠fica de neg√≥cio.

---

### Influenciadores de Vendas
- Uso do visual de IA ‚ÄúKey Influencers‚Äù  
- Permite identificar fatores que aumentam o valor de venda  
- Complementa an√°lises tradicionais com insights estat√≠sticos

---

### Vendas por Categoria
- Treemap ‚Üí mix  
- Linha ‚Üí evolu√ß√£o  
- Tabela ‚Üí detalhe  
- Waterfall ‚Üí contribui√ß√£o de lucro  

**Motivo:**  
Combina√ß√£o ideal para entender **mix + tend√™ncia + lucratividade**.

---

### Performance de Vendedores
- Ranking ‚Üí quem vende mais  
- Ticket m√©dio ‚Üí quem vende melhor  
- Tabela ‚Üí detalhe operacional  
- KPIs ‚Üí vis√£o consolidada  

**Motivo:**  
Permite avaliar efici√™ncia individual e por loja.

---

## üéõ 3.5 Decis√µes sobre Filtros e Intera√ß√µes

### Filtros sincronizados:
- Per√≠odo  
- Loja  
- Vendedor  
- Categoria  

**Motivo:**  
Permite an√°lises compar√°veis entre p√°ginas.

### Intera√ß√µes editadas:
- Treemap filtra todos os visuais  
- Ranking destaca s√©ries no gr√°fico temporal  
- Tabelas n√£o filtram KPIs (evita distor√ß√µes)

---

## üß† 3.6 Decis√µes sobre DAX

### Uso de:
- `DIVIDE()` ‚Üí evita erros de divis√£o por zero  
- `SUMX()` ‚Üí c√°lculos linha a linha  
- `RANKX()` ‚Üí rankings din√¢micos  
- `TOTALYTD()` e `SAMEPERIODLASTYEAR()` ‚Üí an√°lises temporais  
- `ALL()` e `ALLSELECTED()` ‚Üí controle de contexto  

**Motivo:**  
Boas pr√°ticas de DAX para garantir precis√£o e performance.

---

## üöÄ 3.7 Decis√µes sobre Storytelling e UX

- Paleta de cores consistente  
- √çcones para navega√ß√£o lateral  
- T√≠tulos claros e objetivos  
- Notas explicativas em cada p√°gina  
- Layout limpo e com hierarquia visual  

**Motivo:**  
Melhorar a experi√™ncia do usu√°rio e facilitar leitura executiva.

---

## üìå 3.8 Resumo das decis√µes

- Modelo estrela para governan√ßa  
- Medidas DAX padronizadas  
- Visuais escolhidos com prop√≥sito claro  
- Filtros sincronizados entre p√°ginas  
- Estrutura narrativa orientada √† tomada de decis√£o  
- Script C# para produtividade e padroniza√ß√£o  

---

# üß± 4. BOAS PR√ÅTICAS DE MODELAGEM  
### Diretrizes aplicadas no projeto para garantir performance, governan√ßa e escalabilidade

Esta se√ß√£o documenta as boas pr√°ticas adotadas na constru√ß√£o do modelo sem√¢ntico do Power BI, garantindo que o dashboard seja eficiente, sustent√°vel e f√°cil de evoluir.

---

## üß© 4.1 Estrutura em Modelo Estrela

O projeto segue rigorosamente o padr√£o **Star Schema**, composto por:

- **1 tabela fato**: F_Vendas  
- **4 dimens√µes**: Produto, Tempo, Loja, Vendedor  

### Benef√≠cios:
- Reduz ambiguidade de relacionamentos  
- Melhora performance de c√°lculos DAX  
- Facilita cria√ß√£o de medidas reutiliz√°veis  
- Suporta escalabilidade do modelo  

---

## üîÑ 4.2 Relacionamentos Unidirecionais

Todos os relacionamentos foram configurados como:

- **1:N (um para muitos)**  
- **Dire√ß√£o de filtro: Dimens√£o ‚Üí Fato**

### Motivos:
- Evita loops e ambiguidade  
- Mant√©m o fluxo de filtro previs√≠vel  
- Melhora performance em visuais complexos  

---

## üßÆ 4.3 Medidas ao inv√©s de Colunas Calculadas

Sempre que poss√≠vel, foram utilizadas **medidas DAX**, n√£o colunas calculadas.

### Vantagens:
- Medidas s√£o calculadas sob demanda  
- Reduz tamanho do modelo  
- Evita recomputa√ß√µes desnecess√°rias  
- Permite reutiliza√ß√£o em m√∫ltiplos visuais  

---

## üéõ 4.4 Uso de Fun√ß√µes DAX Otimizadas

- `DIVIDE()` para evitar erros de divis√£o  
- `SUMX()` apenas quando necess√°rio  
- `CALCULATE()` para manipular contexto  
- `ALL()` e `ALLSELECTED()` para controle de filtros  
- Fun√ß√µes de tempo (`TOTALYTD`, `SAMEPERIODLASTYEAR`) para an√°lises temporais  

---

## üé® 4.5 Padroniza√ß√£o de Formatos

- Valores monet√°rios ‚Üí `R$ #,0.00`  
- Percentuais ‚Üí `0.00%`  
- Rankings ‚Üí sem casas decimais  

Essa padroniza√ß√£o foi automatizada via **script C# no Tabular Editor**.

---

## ‚öôÔ∏è 4.6 Governan√ßa e Organiza√ß√£o

- Cria√ß√£o da tabela **Medidas** para centralizar todas as m√©tricas  
- Tabela oculta para n√£o poluir o painel de campos  
- Nomea√ß√£o clara e consistente das medidas  
- Separa√ß√£o l√≥gica entre medidas simples e derivadas  

---

## üöÄ 4.7 Performance

- Evitou-se uso de `SUMX` sobre tabelas grandes  
- Relacionamentos otimizados  
- Filtros sincronizados apenas quando necess√°rio  
- Visuais limitados a TopN para evitar sobrecarga  

---

# üìò 5. CONCLUS√ÉO DA DOCUMENTA√á√ÉO  
### Encerramento e vis√£o geral do projeto

O projeto **An√°lise Executiva de Performance Comercial ‚Äì Growth Wave** demonstra a aplica√ß√£o pr√°tica de:

- Modelagem dimensional (Star Schema)  
- Constru√ß√£o de KPIs estrat√©gicos  
- Uso avan√ßado de DAX  
- Automa√ß√£o via Tabular Editor (C#)  
- Design de dashboards executivos  
- Storytelling orientado √† tomada de decis√£o  

---

## üéØ Impacto do Projeto

O dashboard permite que gestores:

- Identifiquem oportunidades de crescimento  
- Avaliem lucratividade por categoria e produto  
- Entendam fatores que influenciam o valor de venda  
- Acompanhem performance de vendedores e lojas  
- Tomem decis√µes baseadas em dados, n√£o em intui√ß√£o  

---

## üß† Aprendizados

Durante o desenvolvimento, foram refor√ßados conceitos como:

- Import√¢ncia de um modelo estrela bem estruturado  
- Poder do DAX para an√°lises avan√ßadas  
- Valor da automa√ß√£o para produtividade  
- Necessidade de narrativa clara em dashboards executivos  

---

## üöÄ Evolu√ß√µes Futuras

- Inclus√£o de metas (Budget vs. Actual)  
- Implementa√ß√£o de RLS (Row-Level Security)  
- Conex√£o com banco de dados em tempo real  
- Publica√ß√£o no Power BI Service com alertas  
- Expans√£o para an√°lise de clientes e churn  

---

## üìé Finaliza√ß√£o

Este documento consolida toda a l√≥gica t√©cnica, anal√≠tica e estrutural do projeto, servindo como refer√™ncia para:

- Recrutadores  
- Avaliadores t√©cnicos  
- Outros analistas de BI  
- Evolu√ß√£o futura do dashboard  

A documenta√ß√£o est√° completa e pronta para ser adicionada ao reposit√≥rio GitHub.

